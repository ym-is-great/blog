 
<html build-time="2020-12-01 00:19">
  <head>
    <title>手把手教你开发一个微信小程序</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
    <link rel="icon" href="/img/favicon.png">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_2235676_71rm12z746w.css">
    <link rel="stylesheet" href="/libs/prism/prism.default.css">
    <link rel="stylesheet" href="/css/index.css?t=202012010019">
  <meta name="generator" content="Hexo 5.2.0"></head>
  <body ontouchstart="">
    <div class="head">
  <div class="header">
    <div class="title">
      <a href="/"></a>ymcai</a>
    </div>
    <div class="menu">
      <a href="/">
        <span class="menu-item">首页</span>
      </a>
      <a href="/categories">
        <span class="menu-item">分类</span>
      </a>
      <a href="/about">
        <span class="menu-item">关于</span>
      </a>
    </div>
  </div>
</div>
    <div class="body">
  <div class="container">
     

<div class="post-header">
  <h1 class="post-title">手把手教你开发一个微信小程序</h1>
  <div class="post-meta">
    <span>2017-03-28</span>
    
      
      <a class="post-meta-category" href="/categories/categories/web-front-end">Web 前端</a>
    
  </div>
</div>
<div class="post-body main-body">
  <p>由于工作需要，我最近开始学习微信小程序，看过几天文档后决定写一个简单的小程序练手，就做一个 To-do List 工具。为了日后温故，也为让有需要的朋友参考，我把开发的过程记录了下来。</p>
<a id="more"></a>

<p>先看一下完成后的效果：</p>
<img src="/img/posts/2017/03/mini_program_practice.gif" class="" width="240" title="功能预览">

<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>你应该具备一些基础的 Web 知识储备（HTML、CSS、JavaScript），用过 React、Vue 等前端框架更佳。访问 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/devtools.html">官网</a> 下载微信 Web 开发者工具，接下来的开发只需要在这一个工具上进行。</p>
<h3 id="创建应用"><a href="#创建应用" class="headerlink" title="创建应用"></a>创建应用</h3><p>使用你的微信号登录微信 Web 开发者工具，选择“本地小程序项目”，然后添加一个新项目。虽然不填写 AppID 也可以继续，但功能受到限制，建议开发者先注册小程序并获取 AppID 。</p>
<p>勾选“在当前目录中创建 quick start 项目”的情况下，微信默认将创建一个 demo 程序。通过这些自动创建的文件，可以一窥小程序的目录结构：</p>
<pre class="line-numbers language-none"><code class="language-none">To-do List
│  app.js          # 全局脚本
│  app.json        # 全局配置
│  app.wxss        # 全局样式
│  
├─pages
│  ├─index         # 页面
│  │   index.js    # 页面脚本
│  │   index.wxml  # 页面结构
│  │   index.wxss  # 页面样式
│  │      
│  └─logs
│      logs.js
│      logs.json
│      logs.wxml
│      logs.wxss
│          
└─utils
   util.js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>一个小程序主要由 wxml 结构文件、wxss 样式文件、js 脚本文件构成，和网页的构成非常相似。页面存放在 pages 目录下，该目录下的每一个目录等价于一个页面。注意，一个小程序至少应该有一个页面。</p>
<p>本例的小程序保留全局文件和一个页面就够了，多余的目录和文件可以删除。</p>
<p>得到如下目录结构：</p>
<pre class="line-numbers language-none"><code class="language-none">To-do List
│  app.js
│  app.json
│  app.wxss
│  
└─pages
   └─index
       index.js
       index.wxml
       index.wxss<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h3><p><code>app.json</code> 是小程序的全局配置文件，用于声明小程序包含的页面、修改导航栏样式等。</p>
<p>我们要开发的小程序包含一个 index 页面，所以应该在 <code>pages</code> 中注册该页面的路径。然后在 <code>window</code> 中设置导航栏的背景色为紫色，标题就叫 <code>To-do List</code> 吧，标题的颜色设为白色。（更多配置项参考 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html">配置</a> ）</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token string">"pages"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token string">"pages/index/index"</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token string">"window"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token string">"navigationBarBackgroundColor"</span><span class="token operator">:</span> <span class="token string">"#512da8"</span><span class="token punctuation">,</span>
  <span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"To-do List"</span><span class="token punctuation">,</span>
  <span class="token string">"navigationBarTextStyle"</span><span class="token operator">:</span> <span class="token string">"white"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="框架语法"><a href="#框架语法" class="headerlink" title="框架语法"></a>框架语法</h3><p>在继续开发之前，你需要了解小程序框架的一些基础用法。</p>
<p>在 wxml 文档中可以用双大括号引用 js 文档中的变量。（参考 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/data.html">数据绑定</a> ）</p>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;!-- wxml --&gt;
&lt;view&gt; &#123;&#123; message &#125;&#125; &lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    message<span class="token operator">:</span> <span class="token string">'Hello World!'</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;!-- 结果 --&gt;
&lt;view&gt; Hello World! &lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>在 wxml 文档中可以用 <code>wx:if</code> 判断是否要渲染该代码块 。以下面这段代码为例，当 <code>condition</code> 的值为 false、0 或空时，该代码块不会被渲染，页面中不会出现“Hello World!”。（参考 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/conditional.html">条件渲染</a>）</p>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;!-- wxml --&gt;
&lt;view wx:if&#x3D;&quot;&#123;&#123; condition &#125;&#125;&quot;&gt; Hello World! &lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>在 wxml 文档中可以用 <code>wx:for</code> 使用数组中的各项重复渲染，一般用于渲染列表。（参考 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/list.html">列表渲染</a> ）</p>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;!-- wxml --&gt;
&lt;view wx:for&#x3D;&quot;&#123;&#123; array &#125;&#125;&quot;&gt; &#123;&#123; index &#125;&#125; - &#123;&#123; item &#125;&#125; &lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    array<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'World'</span> <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;!-- 结果 --&gt;
&lt;view&gt; 0 - Hello &lt;&#x2F;view&gt;
&lt;view&gt; 1 - World &lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h3><p>我用视图组件将页面分成了 <code>head</code>、<code>body</code>、<code>foot</code> 三个部分。<code>head</code> 提供一个输入框，用于添加新任务。<code>body</code> 用于显示待处理项目列表。<code>foot</code> 用于显示已完成项目列表。</p>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;!-- index.wxml --&gt;
&lt;view class&#x3D;&quot;head&quot;&gt; ... &lt;&#x2F;view&gt;
&lt;view class&#x3D;&quot;body&quot;&gt; ... &lt;&#x2F;view&gt;
&lt;view class&#x3D;&quot;foot&quot;&gt; ... &lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>在 <code>head</code> 中添加一个 <code>input</code> 组件。类名 <code>class</code> 和输入框的值 <code>value</code> 分别与变量绑定。<code>placeholder</code> 和 <code>placeholder-style</code> 属性设置了提示文本的内容和样式。<code>bindfocus</code> 、<code>bindblur</code>、<code>bindconfirm</code> 分别是输入框的聚焦、失焦和提交事件。</p>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;view class&#x3D;&quot;head&quot;&gt;
  &lt;input
    class&#x3D;&quot;&#123;&#123; input.class &#125;&#125;&quot;
    value&#x3D;&quot;&#123;&#123; input.value &#125;&#125;&quot;
    placeholder&#x3D;&quot;需要做什么？&quot;
    placeholder-style&#x3D;&quot;color:#fff&quot;
    bindfocus&#x3D;&quot;focus&quot;
    bindblur&#x3D;&quot;blur&quot;
    bindconfirm&#x3D;&quot;confirm&quot;&#x2F;&gt;
&lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>body</code> 视图添加一个复选框 <code>checkbox-group</code> 组件并渲染一个待处理项目列表。<code>bindchange</code> 事件用于监听子组件 <code>checkbox</code> 的变化，当用户勾选 <code>checkbox</code> 时做一些事。</p>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;view class&#x3D;&quot;body&quot;&gt;
  &lt;!-- 项目被勾选时调用 check 方法。 --&gt;
  &lt;checkbox-group bindchange&#x3D;&quot;check&quot;&gt;
    &lt;!-- 渲染未完成项目列表。 --&gt;
    &lt;view class&#x3D;&quot;item&quot; wx:for&#x3D;&quot;&#123;&#123; items &#125;&#125;&quot; wx:key&#x3D;&quot;&#123;&#123; index &#125;&#125;&quot; wx:if&#x3D;&quot;&#123;&#123; !item.status &#125;&#125;&quot;&gt;
      &lt;!-- 复选框的值为项目的索引（以便知道哪个复选框的状态发生改变），默认不选中。 --&gt;
      &lt;checkbox value&#x3D;&quot;&#123;&#123; index &#125;&#125;&quot; checked&#x3D;&quot;&#123;&#123; false &#125;&#125;&quot;&#x2F;&gt;
      &lt;!-- 输出项目名称 --&gt;
      &lt;text&gt;&#123;&#123; item.name &#125;&#125;&lt;&#x2F;text&gt;
      &lt;!-- 删除图标，点击时调用 remove 方法，参数 index 为项目索引。 --&gt;
      &lt;icon type&#x3D;&quot;cancel&quot; size&#x3D;&quot;30&quot; color&#x3D;&quot;#EF5350&quot; bindtap&#x3D;&quot;remove&quot; data-index&#x3D;&quot;&#123;&#123; index &#125;&#125;&quot;&#x2F;&gt;
    &lt;&#x2F;view&gt;
  &lt;&#x2F;checkbox-group&gt;
  &lt;!-- 当 items 中没有元素时的提示。 --&gt;
  &lt;view class&#x3D;&quot;empty&quot; wx:if&#x3D;&quot;&#123;&#123; items.length &#x3D;&#x3D; 0 &#125;&#125;&quot;&gt;
    &lt;icon type&#x3D;&quot;success&quot; size&#x3D;&quot;20&quot; color&#x3D;&quot;&#123;&#123; item &#125;&#125;&quot;&#x2F;&gt;
    &lt;text&gt;无待办事项&lt;&#x2F;text&gt;
  &lt;&#x2F;view&gt;
&lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>foot</code> 视图的结构和 <code>body</code> 视图基本一致，渲染一个已完成项目列表。已完成项目一定是打了钩的，所以其中的 <code>checkbox</code> 默认选中。<code>checkbox-group</code> 组件的 <code>bindchange</code> 事件用于监听用户取消勾选。</p>
<pre class="line-numbers language-xhtml" data-language="xhtml"><code class="language-xhtml">&lt;view class&#x3D;&quot;foot&quot;&gt;
  &lt;!-- 项目被取消勾选时调用 uncheck 方法。 --&gt;
  &lt;checkbox-group bindchange&#x3D;&quot;uncheck&quot;&gt;
    &lt;!-- 渲染已完成项目列表。 --&gt;
    &lt;view class&#x3D;&quot;item&quot; wx:for&#x3D;&quot;&#123;&#123; items &#125;&#125;&quot; wx:key&#x3D;&quot;&#123;&#123; index &#125;&#125;&quot; wx:if&#x3D;&quot;&#123;&#123; item.status &#125;&#125;&quot;&gt;
      &lt;!-- 复选框默认选中。 --&gt;
      &lt;checkbox value&#x3D;&quot;&#123;&#123; index &#125;&#125;&quot; checked&#x3D;&quot;&#123;&#123; true &#125;&#125;&quot;&#x2F;&gt;
      &lt;text&gt;&#123;&#123; item.name &#125;&#125;&lt;&#x2F;text&gt;
      &lt;icon type&#x3D;&quot;cancel&quot; size&#x3D;&quot;30&quot; color&#x3D;&quot;#EF5350&quot; bindtap&#x3D;&quot;remove&quot; data-index&#x3D;&quot;&#123;&#123; index &#125;&#125;&quot;&#x2F;&gt;
    &lt;&#x2F;view&gt;
  &lt;&#x2F;checkbox-group&gt;
&lt;&#x2F;view&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="页面脚本"><a href="#页面脚本" class="headerlink" title="页面脚本"></a>页面脚本</h3><p>首先是数据部分。渲染页面使用的数据来自 <code>data</code> ，换言之在 <code>data</code> 中声明的变量可以在 wxml 中使用（打印出来）。本例声明的数据包括输入框类名 <code>input.class</code> ，用于动态修改输入框的样式，输入框的值 <code>input.value</code> 以及存储待办事项的数组 <code>items</code> 。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    input<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">class</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    items<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>items</code> 中的待办事项以对象形式存在。<code>name</code> 属性是待办事项的名称，<code>status</code> 属性是待办事项的状态（0=待处理 1=已完成）。页面中通过 <code>status</code> 的值控制待处理项目列表、已完成项目列表的内容。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">items<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">'阅读官方文档'</span><span class="token punctuation">,</span> status<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">'写一个小程序'</span><span class="token punctuation">,</span> status<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>focus</code> 方法和 <code>blur</code> 方法分别在输入框获取和失去焦点时调用，通过改变 <code>input.class</code> 的值修改输入框的样式。</p>
<p>注：在小程序中，修改数据必须使用 <code>setData</code> 方法才能使变化应用到页面上。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 输入框获取焦点事件</span>
<span class="token function-variable function">focus</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token string">'input.class'</span><span class="token operator">:</span> <span class="token string">'focused'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>

<span class="token comment">// 输入框失去焦点事件</span>
<span class="token function-variable function">blur</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token string">'input.class'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>confirm</code> 方法在用户提交内容时调用，新增一个待办事项并清空输入框。通过参数中的 <code>event.detail.value</code> 可以取到输入框的值。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 输入框内容提交事件</span>
<span class="token function-variable function">confirm</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 判断是否有值</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 新增一个待处理项目</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> name<span class="token operator">:</span> event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">,</span> status<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token comment">// 更新页面</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token string">'items'</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token comment">// 清空输入框</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token string">'input.value'</span> <span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>check</code> 方法和 <code>uncheck</code> 方法分别在用户勾选待处理项目、取消勾选已完成项目时调用，用于修改数据并更新页面。通过参数中的 <code>event.detail.value</code> 获取到的是 <code>checkbox-group</code> 中所有已选 <code>checkbox</code> 的索引组成的数组。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 复选框选中事件</span>
<span class="token function-variable function">check</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 获得已勾选项目索引</span>
  <span class="token keyword">let</span> index <span class="token operator">=</span> event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token comment">// 将被勾选项目的状态设为 1</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token comment">// 更新页面</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token string">'items'</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token comment">// 复选框取消选中事件</span>
<span class="token function-variable function">uncheck</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 将所有项目的状态设为 0</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">&#125;</span>
  <span class="token comment">// 将被勾选项目的状态设为 1</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> event<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token punctuation">&#125;</span>
  <span class="token comment">// 更新页面</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token string">'items'</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>remove</code> 方法在用户点击项目的“删除”图标时调用，它将移除相应的元素并更新页面。</p>
<p>可能有人会问：为什么 <code>event.target.dataset.index</code> 是项目索引呢？这是因为事先在 <code>icon</code> 组件上使用了自定义属性 <code>data-index</code> 向事件传参。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 删除按钮点击事件</span>
<span class="token function-variable function">remove</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 获得待删除项目索引</span>
  <span class="token keyword">let</span> index <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>index
  <span class="token comment">// 移除元素</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token comment">// 更新页面</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token string">'items'</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>items <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="页面样式"><a href="#页面样式" class="headerlink" title="页面样式"></a>页面样式</h3><p>小程序的样式表与 CSS 并无二致。扩展了根据屏幕宽度进行自适应的 <code>rpx</code> 单位。（参考 <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxss.html">WXSS</a> ）</p>
<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">text</span> <span class="token punctuation">&#123;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">checkbox, text, icon</span> <span class="token punctuation">&#123;</span>
  <span class="token property">vertical-align</span><span class="token punctuation">:</span>middle<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">icon</span> <span class="token punctuation">&#123;</span>
  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">view.head</span> <span class="token punctuation">&#123;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #3F51B5<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 120rpx 50rpx<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">view.head input</span> <span class="token punctuation">&#123;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 30pt<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 20pt<span class="token punctuation">;</span>
  <span class="token property">-webkit-transition</span><span class="token punctuation">:</span> all 0.5s<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> all 0.5s<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">view.head input.focused</span> <span class="token punctuation">&#123;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 28pt<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">view.body .item, .foot .item</span> <span class="token punctuation">&#123;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 14pt<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 40rpx 50rpx<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #eeeeee<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">view.foot .item text</span> <span class="token punctuation">&#123;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #bbbbbb<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">view.empty</span> <span class="token punctuation">&#123;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 12pt<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 50rpx<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">view.empty text</span> <span class="token punctuation">&#123;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">view.empty icon</span> <span class="token punctuation">&#123;</span>
  <span class="token property">float</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现在你可以在开发者工具的“项目”选项卡中预览或上传这个小程序了。如果想体验一下这个小程序的运行效果，可以在微信中搜索已上线的版本“小待办”。</p>
<p>相关环境：Windows 10 x64 / WeChat Web DevTools 0.15 / WeChat 6.5.6</p>

  
    <div class="post-tags">
    
      
      <a class="post-tag" href="/tags/%E5%BE%AE%E4%BF%A1">微信</a>
    
      
      <a class="post-tag" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F">小程序</a>
    
  </div>
  
</div>
<div class="page-footer">
  <div class="page-footer-links">
    <a class="page-footer-link" href="javascript:history.back()">返回</a>
    
      <a class="page-footer-link" href="">
        下一篇：Sass 快速入门
      </a>
     
  </div>
</div>

  </div>
</div>
    <div class="foot">
  <div class="footer">
    <span class="copyright">©️2020 ymcai.xyz</span>
    <a href="http://www.beian.miit.gov.cn" target="_blank">粤ICP备20041235 </a>
  </div>
</div>

<script type="text/javascript">
function wrapTables() {
  var nodes = document.body.querySelectorAll('table');
  for (var i = 0; i < nodes.length; i++) {
    var table = nodes[i];
    var wrapEl = document.createElement('div');
    wrapEl.className = 'table-wrap';
    table.parentNode.replaceChild(wrapEl, table);
    wrapEl.appendChild(table)
  }
};
wrapTables();
</script>
  </body>
</html>