 
<html build-time="2020-12-01 00:19">
  <head>
    <title>手动下载和安装 Homestead</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
    <link rel="icon" href="/img/favicon.png">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_2235676_71rm12z746w.css">
    <link rel="stylesheet" href="/libs/prism/prism.default.css">
    <link rel="stylesheet" href="/css/index.css?t=202012010019">
  <meta name="generator" content="Hexo 5.2.0"></head>
  <body ontouchstart="">
    <div class="head">
  <div class="header">
    <div class="title">
      <a href="/"></a>ymcai</a>
    </div>
    <div class="menu">
      <a href="/">
        <span class="menu-item">首页</span>
      </a>
      <a href="/categories">
        <span class="menu-item">分类</span>
      </a>
      <a href="/about">
        <span class="menu-item">关于</span>
      </a>
    </div>
  </div>
</div>
    <div class="body">
  <div class="container">
     

<div class="post-header">
  <h1 class="post-title">手动下载和安装 Homestead</h1>
  <div class="post-meta">
    <span>2016-10-24</span>
    
      
      <a class="post-meta-category" href="/categories/categories/back-end">后端</a>
    
  </div>
</div>
<div class="post-body main-body">
  <p>在配置 Homestead 开发环境的过程中，执行以下命令将下载1G左右的镜像文件（Vagrant Box），然后安装包含完整 Homestead 环境的虚拟机。由于资源服务器位于海外，经常导致下载速度缓慢、下载失败等问题。</p>
<a id="more"></a>

<pre class="line-numbers language-none"><code class="language-none">vagrant box add laravel&#x2F;homestead<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们可在命令行中找到 <em>box: Downloading</em> 开头的一行，后面就是 Vagrant Box 文件的下载链接。将链接复制到迅雷等工具下载，得到拓展名为 box 的镜像文件。</p>
<pre class="line-numbers language-none"><code class="language-none">vagrant box add laravel&#x2F;homestead
&#x3D;&#x3D;&gt; box: Loading metadata for box &#39;laravel&#x2F;homestead&#39;
...
box: Downloading:  https:&#x2F;&#x2F;atlas.hashicorp.com&#x2F;laravel&#x2F;boxes&#x2F;homestead&#x2F;versions&#x2F;0.5.0&#x2F;providers&#x2F;virtualbox.box<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后选择以下任意一种方式安装虚拟机。</p>
<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>第一步，执行以下命令通过刚刚下载的镜像文件添加虚拟机。</p>
<pre class="line-numbers language-none"><code class="language-none"># Linux
vagrant box add laravel&#x2F;homestead ~&#x2F;virtualbox.box

# Windows
vagrant box add laravel&#x2F;homestead file:&#x2F;&#x2F;&#x2F;d:&#x2F;virtualbox.box<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注意，此时通过 <code>vagrant up</code> 命令启动虚拟机时，仍会下载镜像文件。这是因为 Vagrant 认为该虚拟机的版本过低，于是自动下载最新版本的镜像（即使刚刚离线安装的虚拟机已是最新版）。</p>
<p>第二步，解决版本识别错误问题。只需修改 Vagant 的索引文件即可解决，该文件参考路径如下。</p>
<pre class="line-numbers language-none"><code class="language-none">C:\Users\YIMING\\.vagrant.d\data\machine-index\index<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">&quot;box&quot;:&#123;
2&quot;name&quot;:&quot;laravel&#x2F;homestead&quot;,
2&quot;provider&quot;:&quot;virtualbox&quot;,
2&quot;version&quot;:&quot;0.5.0&quot;&#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>该方法需目录下已存在 index 文件可供修改，或者你已经很熟悉这个文件的格式。index 文件以 JSON 格式存储着已（通过Vagrant）安装的虚拟机的信息。将 version 字段修改为可用的版本号即可，然后再次尝试 <code>vagrant up</code> 启动虚拟机。</p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>第一步，执行 <code>vagrant box add laravel/homestead</code> 触发下载镜像文件，然后马上按 Ctrl+C 取消。</p>
<p>第二步，在 ~\.vagrant.d\tmp 目录下找到下载时生成的缓存文件。文件名类似：</p>
<pre class="line-numbers language-none"><code class="language-none">boxb1926d351572dd849646d59563156601f026e2a5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>第三步，将之前手动下载的镜像文件重命名为缓存文件的文件名，并覆盖缓存文件。</p>
<p>第四步，执行 <code>vagrant box add laravel/homestead</code> ，下载进度将直接显示为100%，并开始添加虚拟机。</p>
<p>简单总结一下。这两种方法都是我探索后发现的、退而求其次地安装 Homestead 虚拟机的方法。前者直接用命令通过本地镜像安装，但会出现 Vagrant 认错版本的尴尬（或许日后的版本更新可以修复）。后者则用本地镜像文件，替换掉缓存文件，欺骗 Vagrant 下载已完成从而执行安装。后者不需要纠正版本识别错误。</p>
<p>相关环境：Windows 10 x64 / VirtualBox 5.1.8 / Laravel Homestead</p>

  
    <div class="post-tags">
    
      
      <a class="post-tag" href="/tags/Homestead">Homestead</a>
    
  </div>
  
</div>
<div class="page-footer">
  <div class="page-footer-links">
    <a class="page-footer-link" href="javascript:history.back()">返回</a>
    
      <a class="page-footer-link" href="">
        下一篇：Homestead 开发环境配置
      </a>
     
  </div>
</div>

  </div>
</div>
    <div class="foot">
  <div class="footer">
    <span class="copyright">©️2020 ymcai.xyz</span>
    <a href="http://www.beian.miit.gov.cn" target="_blank">粤ICP备20041235 </a>
  </div>
</div>

<script type="text/javascript">
function wrapTables() {
  var nodes = document.body.querySelectorAll('table');
  for (var i = 0; i < nodes.length; i++) {
    var table = nodes[i];
    var wrapEl = document.createElement('div');
    wrapEl.className = 'table-wrap';
    table.parentNode.replaceChild(wrapEl, table);
    wrapEl.appendChild(table)
  }
};
wrapTables();
</script>
  </body>
</html>